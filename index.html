<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿éšªçŸ¥è­˜ç‹ - å°¾ç‰™å¤§äº‚é¬¥</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <style>
        body { background-color: #111827; color: white; font-family: "Microsoft JhengHei", sans-serif; overflow-x: hidden; touch-action: manipulation; }
        .btn-push { transition: transform 0.1s; } .btn-push:active { transform: scale(0.95); }
        .animate-pop { animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ==========================================
        // âœ… è¨­å®šå·²å®Œæˆï¼é‡‘é‘°å·²è‡ªå‹•å¡«å…¥
        // ==========================================
        const FIREBASE_CONFIG = {
            projectId: "cathaylife-e0714", 
            apiKey: "AIzaSyDoeEnc5-cebY6RfWAYnGM5y1BwLHFG5_g"    
        };

        // ==========================================
        // â–¼â–¼â–¼ é¡Œç›®å€ (å¯éš¨æ™‚å›ä¾†ä¿®æ”¹æ–‡å­—) â–¼â–¼â–¼
        // ==========================================
        const QUESTIONS = [
            { q: "é‡å°ç”·æ€§èˆ‡å¥³æ€§å®¹æ˜“ç™¼ç”Ÿçš„ç‰¹å®šç™Œç—‡ï¼Œå“ªä¸€å°ã€Œæƒ…ä¾¶æª”ã€å•†å“å¯åŠ ç¢¼çµ¦ä»˜ 50%ï¼Ÿ", opts: ["(A) ç¾…å¯†æ­ èˆ‡ èŒ±éº—è‘‰", "(B) è±ªåº·æ„›(ç”·) èˆ‡ å¥½åº·æ„›(å¥³)", "(C) çœŸå¿ƒå®‰ èˆ‡ çœŸå®‰å®‰", "(D) å¤§é™¸æ–°å¨˜ èˆ‡ å°ç£éƒ"], ans: 1, note: "é‡å°ç‰¹å®šæ€§åˆ¥ç™Œç—‡ï¼Œç¬¬6å¹´å¾Œæœ€é«˜é¡å¤–çµ¦ä»˜ 50%ã€‚" },
            { q: "å“ªä¸€å¼µç¾å…ƒä¿å–®ï¼Œåå­—è½èµ·ä¾†ã€Œå¥åº·åˆè³ºéŒ¢ã€ï¼Œä¸”å…¼é¡§ã€Œç™Œç—‡(é‡åº¦)æå‰çµ¦ä»˜ã€ï¼Ÿ", opts: ["(A) ç¾æ„›åº·ç›ˆ", "(B) ç¾åˆ©ç››è®š", "(C) ç¾æ»¿é›™å¯¶", "(D) ç¾éº—äººç”Ÿ"], ans: 0, note: "ã€Œç¾æ„›åº·ç›ˆã€åˆ©è®Šå‹ + ç™Œç—‡æå‰çµ¦ä»˜ï¼Œå…¼é¡§è²¡å¯Œèˆ‡å¥åº·ã€‚" },
            { q: "é‡å°é«˜é½¡æ—ç¾¤(55-75æ­²)ï¼Œåªè¦æ´»åˆ°91æ­²å°±èƒ½é ˜å›ä¸€åŠä¿è²»çš„æ„å¤–éšªæ˜¯ï¼Ÿ", opts: ["(A) æ¨‚äº«å¹³å®‰", "(B) é ¤é¤Šå¤©å¹´", "(C) é•·å‘½ç™¾æ­²", "(D) ç¦å¦‚æ±æµ·"], ans: 0, note: "ã€Œæ¨‚äº«å¹³å®‰ã€é‡å°é«˜é½¡è¨­è¨ˆï¼Œ91æ­²ä»ç”Ÿå­˜çµ¦ä»˜ç¸½ä¿è²» 50%ã€‚" },
            { q: "ä¿éšªæ¥­å‹™å“¡æœ€å²å®³çš„è¶…èƒ½åŠ›æ˜¯ä»€éº¼ï¼Ÿ", opts: ["(A) éš±å½¢", "(B) ä»»ä½•è©±é¡Œéƒ½èƒ½èŠåˆ°ä¿éšª", "(C) é£›è¡Œ", "(D) å¥½è…°åŠ›"], ans: 1, note: "é€™å°±æ˜¯å°ˆæ¥­ï¼éš¨æ™‚éš¨åœ°æ•£æ’­æ„›çš„ç¨®å­ï¼" },
            { q: "é‡åˆ°ã€Œå¥§å®¢ã€çš„æ™‚å€™ï¼Œå¿ƒè£¡è¦é»˜å¿µä»€éº¼å’’èªï¼Ÿ", opts: ["(A) åŠ ä¸Šå»ï¼çµ¦ä»–æ­»ï¼", "(B) è«ç”Ÿæ°£ï¼Œæ°£å‡ºç—…ä¾†ç„¡äººæ›¿", "(C) èˆ¬è‹¥æ³¢ç¾…èœœ", "(D) æ€¥æ€¥å¦‚å¾‹ä»¤"], ans: 1, note: "æˆ–æ˜¯é»˜å¿µï¼šã€Œä¸‹ä¸€ä½æœƒæ›´å¥½ï¼ã€ä¿æŒæ­£èƒ½é‡ã€‚" },
            { q: "å®œè˜­å¤šé›¨è·¯æ»‘ï¼Œé¨æ©Ÿè»Šæ€•çŠç”°ã€‚å“ªå¼µé™„ç´„æ˜¯ã€Œéª¨æŠ˜æ•‘æ˜Ÿã€ï¼Œé€£è„«è‡¼éƒ½è³ ï¼Ÿ", opts: ["(A) å‹å‹‡å¥", "(B) æ–°é‡‘éª¨åŠ›", "(C) éµç‰›é‹åŠŸæ•£", "(D) çœŸçš„å¥½ç—›"], ans: 1, note: "ã€Œæ–°é‡‘éª¨åŠ›ã€é‡å°éª¨æŠ˜ã€è„«è‡¼æœ‰ç‰¹åˆ¥ä¿éšœï¼Œæ©Ÿè»Šæ—å¿…å‚™ã€‚" },
            { q: "ã€è…¦ç­‹æ€¥è½‰å½ã€‘ä¸€éš»å…¬é›ååœ¨å±‹é ‚ä¸Šï¼Œè«‹å•ç‰ ä¸‹çš„è›‹æœƒå¾€å“ªé‚Šæ‰ï¼Ÿ", opts: ["(A) å·¦é‚Š", "(B) å³é‚Š", "(C) å±‹é ‚ä¸­é–“", "(D) å…¬é›ä¸æœƒä¸‹è›‹"], ans: 3, note: "ç¶“å…¸é™·é˜±é¡Œï¼å…¬é›æ˜¯ä¸æœƒä¸‹è›‹çš„ï¼" },
            { q: "ã€è…¦ç­‹æ€¥è½‰å½ã€‘å“ªä¸€å€‹å¡é€šäººç‰©æœ€å–œæ­¡å¹«åŠ©åˆ¥äººï¼Ÿ", opts: ["(A) å“†å•¦Aå¤¢", "(B) å·§è™", "(C) ä½©ä½©è±¬", "(D) éºµåŒ…è¶…äºº"], ans: 1, note: "å› ç‚ºã€Œå·§è™ã€æ•‘æ´ (å‰›å¥½æ•‘äºº)ï¼å°èªè«§éŸ³æ¢—ï¼" },
            { q: "å®œè˜­äººå£é ­ç¦ªï¼Œå½¢å®¹æ±è¥¿ã€Œå¾ˆæ£’ã€å¾ˆå¼·ã€æœƒèªªï¼Ÿ", opts: ["(A) æ°´å•¦", "(B) å‹ (Kå‹)", "(C) ç‹‚", "(D) é ‚"], ans: 1, note: "å®œè˜­äººæ‰æ‡‚ï¼å‹å¥½å‘·ï¼å‹å²å®³ï¼" },
            { q: "å®œè˜­é„‰è¦ªæƒ³æŠŠéŒ¢çœä¸‹ä¾†é¤Šè€ï¼Œå“ªå¼µé˜²ç™Œéšªã€Œ30å¹´æ²’ç†è³ ã€å¯æ‹¿å›éŒ¢ï¼Ÿ", opts: ["(A) æ»¿æº¢åº·æ„›", "(B) æ»¿æ‰‹ç¾é‡‘", "(C) æº¢èµ·å»ç©", "(D) åº·åº·èˆ"], ans: 0, note: "ã€Œæ»¿æº¢åº·æ„›ã€æ²’ç”¨åˆ°é‚„èƒ½æ‹¿å›ä¾†ï¼Œç²¾æ‰“ç´°ç®—é¦–é¸ã€‚" }
        ];

        function App() {
            // ç›´æ¥è·³é setupï¼Œé è¨­é€²å…¥ role-select
            const [view, setView] = useState('role-select'); 
            
            const [db, setDb] = useState(null);
            const [roomCode, setRoomCode] = useState('');
            const [gameState, setGameState] = useState({});
            const [myPlayer, setMyPlayer] = useState({ name: '', score: 0 });
            const [players, setPlayers] = useState([]);

            // åˆå§‹åŒ– Firebase (è‡ªå‹•åŸ·è¡Œ)
            useEffect(() => {
                if (!firebase.apps.length) {
                    try {
                        firebase.initializeApp({
                            apiKey: FIREBASE_CONFIG.apiKey,
                            authDomain: `${FIREBASE_CONFIG.projectId}.firebaseapp.com`,
                            projectId: FIREBASE_CONFIG.projectId
                        });
                        setDb(firebase.firestore());
                    } catch (error) {
                        alert("Firebase è¨­å®šæœ‰èª¤ï¼Œè«‹æª¢æŸ¥ç¨‹å¼ç¢¼ä¸­çš„ API Key å’Œ Project ID");
                        console.error(error);
                    }
                } else {
                    setDb(firebase.firestore());
                }
            }, []);

            // --- ä¸»æŒäººåŠŸèƒ½ ---
            const createRoom = async () => {
                if(!db) return;
                const code = Math.floor(1000 + Math.random() * 9000).toString();
                setRoomCode(code);
                await db.collection('rooms').doc(code).set({
                    step: 'lobby', qIndex: 0, showAnswer: false, 
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                db.collection('rooms').doc(code).onSnapshot(doc => setGameState(doc.data()));
                db.collection('rooms').doc(code).collection('players').onSnapshot(snap => {
                    const list = [];
                    snap.forEach(d => list.push({id: d.id, ...d.data()}));
                    setPlayers(list.sort((a,b) => b.score - a.score));
                });
                setView('host');
            };

            const hostAction = async (action) => {
                if(!db) return;
                const ref = db.collection('rooms').doc(roomCode);
                if (action === 'start') await ref.update({ step: 'question', qIndex: 0, showAnswer: false });
                else if (action === 'reveal') await ref.update({ showAnswer: true, step: 'reveal' });
                else if (action === 'nextQ') {
                    const nextIdx = gameState.qIndex + 1;
                    if (nextIdx >= QUESTIONS.length) await ref.update({ step: 'end' });
                    else await ref.update({ step: 'question', qIndex: nextIdx, showAnswer: false });
                } else if (action === 'leaderboard') await ref.update({ step: 'leaderboard' });
            };

            // --- åƒè³½è€…åŠŸèƒ½ ---
            const joinRoom = async () => {
                if(!db) return alert("é€£ç·šå°šæœªæº–å‚™å¥½ï¼Œè«‹ç¨å¾Œå†è©¦");
                if(!roomCode || !myPlayer.name) return alert("è«‹è¼¸å…¥æˆ¿é–“è™Ÿèˆ‡æš±ç¨±");
                
                const roomRef = db.collection('rooms').doc(roomCode);
                
                try {
                    const doc = await roomRef.get();
                    if(!doc.exists) return alert("æˆ¿é–“ä¸å­˜åœ¨ï¼Œè«‹ç¢ºèªå¤§è¢å¹•è™Ÿç¢¼");

                    const uid = Math.random().toString(36).substr(2, 9);
                    await roomRef.collection('players').doc(uid).set({ name: myPlayer.name, score: 0, lastQ: -1 });
                    setMyPlayer({...myPlayer, uid});

                    roomRef.onSnapshot(doc => setGameState(doc.data()));
                    roomRef.collection('players').doc(uid).onSnapshot(doc => { if(doc.exists) setMyPlayer(p => ({...p, ...doc.data()})); });
                    setView('player');
                } catch (e) {
                    console.error(e);
                    alert("é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ Firebase å¾Œå°æ˜¯å¦å·²é–‹å•Ÿ Firestore Database (æ¸¬è©¦æ¨¡å¼)");
                }
            };

            const playerAnswer = async (optIndex) => {
                if (gameState.step !== 'question' || gameState.qIndex === myPlayer.lastQ) return;
                const points = optIndex === QUESTIONS[gameState.qIndex].ans ? 100 : 0;
                const roomRef = db.collection('rooms').doc(roomCode);
                await roomRef.collection('players').doc(myPlayer.uid).update({
                    score: firebase.firestore.FieldValue.increment(points),
                    lastQ: gameState.qIndex
                });
                setMyPlayer(p => ({...p, lastQ: gameState.qIndex}));
            };

            // ==========================================
            // â–¼â–¼â–¼ ç•«é¢æ¸²æŸ“å€ â–¼â–¼â–¼
            // ==========================================

            // 1. è§’è‰²é¸æ“‡ (é¦–é ) - ç¾åœ¨é€™æ˜¯é è¨­ç•«é¢
            if (view === 'role-select') return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4 space-y-8 bg-gradient-to-b from-gray-900 to-black">
                    <h1 className="text-5xl font-black mb-4 text-center text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-pink-500 drop-shadow-lg">
                        ä¿éšªçŸ¥è­˜ç‹
                    </h1>
                    
                    <div className="flex flex-col md:flex-row gap-6 w-full max-w-4xl justify-center">
                        {/* ä¸»æŒäººæŒ‰éˆ• */}
                        <button onClick={createRoom} className="group relative bg-purple-600 hover:bg-purple-500 w-full md:w-64 h-48 rounded-3xl text-2xl font-bold btn-push overflow-hidden shadow-[0_0_30px_rgba(147,51,234,0.3)]">
                            <div className="absolute inset-0 bg-black/10 group-hover:bg-transparent transition"></div>
                            <div className="relative z-10 flex flex-col items-center gap-2">
                                <span className="text-4xl">ğŸ“º</span>
                                <span>æˆ‘æ˜¯ä¸»æŒäºº</span>
                                <span className="text-sm font-normal opacity-80">(å¤§è¢å¹•ç«¯)</span>
                            </div>
                        </button>

                        {/* åƒè³½è€…å€å¡Š */}
                        <div className="bg-gray-800 w-full md:w-80 h-auto p-6 rounded-3xl flex flex-col justify-center space-y-3 border border-gray-700 shadow-2xl">
                            <div className="text-center font-bold text-xl mb-2 flex items-center justify-center gap-2">
                                <span>ğŸ“±</span> æˆ‘æ˜¯åƒè³½è€…
                            </div>
                            <input placeholder="è¼¸å…¥æˆ¿é–“è™Ÿ (çœ‹å¤§è¢å¹•)" className="w-full p-3 bg-gray-700 rounded-xl text-center text-lg focus:ring-2 ring-green-500 outline-none" value={roomCode} onChange={e=>setRoomCode(e.target.value)} />
                            <input placeholder="è¼¸å…¥ä½ çš„æš±ç¨±" className="w-full p-3 bg-gray-700 rounded-xl text-center text-lg focus:ring-2 ring-green-500 outline-none" value={myPlayer.name} onChange={e=>setMyPlayer({...myPlayer, name: e.target.value})} />
                            <button onClick={joinRoom} className="bg-green-600 hover:bg-green-500 w-full p-3 rounded-xl font-bold text-xl shadow-lg btn-push mt-2">
                                åŠ å…¥æˆ°å±€
                            </button>
                        </div>
                    </div>
                </div>
            );

            // 2. ä¸»æŒäººç•«é¢ (å¤§è¢å¹•)
            if (view === 'host') return (
                <div className="min-h-screen flex flex-col bg-gray-900 text-white">
                    <div className="p-4 bg-gray-800 flex justify-between items-center shadow-md z-10">
                        <div className="flex items-center gap-4">
                            <div className="bg-yellow-500 text-black px-4 py-2 rounded-lg font-mono font-bold text-2xl shadow-lg">
                                æˆ¿é–“ï¼š{roomCode}
                            </div>
                        </div>
                        <div className="text-2xl font-bold">
                            ç·šä¸Šäººæ•¸ï¼š<span className="text-green-400">{players.length}</span> äºº
                        </div>
                    </div>

                    <div className="flex-1 flex flex-col items-center justify-center p-4 text-center overflow-y-auto">
                        {gameState.step === 'lobby' && (
                            <div className="animate-pop w-full max-w-4xl">
                                <h2 className="text-5xl font-black mb-8">è«‹æ‹¿å‡ºæ‰‹æ©Ÿè¼¸å…¥æˆ¿é–“è™Ÿ</h2>
                                <div className="text-[10rem] font-mono font-black text-yellow-400 leading-none mb-12 drop-shadow-[0_0_30px_rgba(250,204,21,0.5)]">
                                    {roomCode}
                                </div>
                                <div className="bg-gray-800/50 p-6 rounded-2xl mb-8 min-h-[100px] border border-gray-700">
                                    <div className="text-gray-400 mb-4 text-sm">å·²åŠ å…¥çš„æˆ°å£«ï¼š</div>
                                    <div className="flex flex-wrap gap-3 justify-center">
                                        {players.map(p => (
                                            <span key={p.id} className="bg-blue-600 px-4 py-2 rounded-full text-lg font-bold shadow-md animate-pop">
                                                {p.name}
                                            </span>
                                        ))}
                                        {players.length === 0 && <span className="text-gray-600 italic">ç­‰å¾…é€£ç·šä¸­...</span>}
                                    </div>
                                </div>
                                <button onClick={() => hostAction('start')} className="bg-green-600 hover:bg-green-500 px-16 py-6 rounded-full text-4xl font-bold shadow-[0_10px_30px_rgba(22,163,74,0.5)] btn-push border-b-4 border-green-800">
                                    é–‹å§‹éŠæˆ² ğŸš€
                                </button>
                            </div>
                        )}

                        {(gameState.step === 'question' || gameState.step === 'reveal') && (
                            <div className="w-full max-w-6xl animate-pop">
                                <div className="text-xl text-gray-400 mb-4 font-bold tracking-widest uppercase">Question {gameState.qIndex + 1}</div>
                                <h2 className="text-4xl md:text-6xl font-black mb-12 leading-tight drop-shadow-lg">
                                    {QUESTIONS[gameState.qIndex].q}
                                </h2>
                                <div className="grid grid-cols-2 gap-6">
                                    {QUESTIONS[gameState.qIndex].opts.map((opt, idx) => (
                                        <div key={idx} className={`p-8 text-3xl font-bold rounded-2xl text-left border-4 transition-all duration-300 ${
                                            gameState.showAnswer 
                                                ? (idx === QUESTIONS[gameState.qIndex].ans 
                                                    ? 'bg-green-900 border-green-500 scale-105 shadow-[0_0_40px_rgba(34,197,94,0.5)]' 
                                                    : 'bg-gray-800 border-transparent opacity-30 grayscale')
                                                : 'bg-gray-800 border-gray-700 hover:border-gray-500'
                                        }`}>
                                            {opt}
                                        </div>
                                    ))}
                                </div>
                                {gameState.showAnswer && (
                                    <div className="mt-8 animate-pop">
                                        <div className="inline-block bg-yellow-600/20 border border-yellow-500 text-yellow-300 text-3xl font-bold px-8 py-4 rounded-xl">
                                            ğŸ’¡ è§£æï¼š{QUESTIONS[gameState.qIndex].note}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {gameState.step === 'leaderboard' && (
                            <div className="w-full max-w-3xl animate-pop">
                                <h2 className="text-5xl font-black mb-8 text-yellow-400 drop-shadow-lg">ğŸ† ç›®å‰æˆ°æ³ ğŸ†</h2>
                                <div className="space-y-4">
                                    {players.slice(0, 5).map((p, idx) => (
                                        <div key={p.id} className={`flex justify-between items-center p-6 rounded-2xl text-3xl font-bold border-2 shadow-xl ${
                                            idx === 0 ? 'bg-gradient-to-r from-yellow-500 to-orange-500 text-black border-yellow-300 scale-110' : 'bg-gray-800 border-gray-700'
                                        }`}>
                                            <div className="flex gap-6 items-center">
                                                <span className={`w-12 h-12 flex items-center justify-center rounded-full ${idx===0 ? 'bg-white text-yellow-600' : 'bg-gray-700 text-gray-400'}`}>
                                                    {idx+1}
                                                </span>
                                                <span>{p.name}</span>
                                            </div>
                                            <div className="font-mono">{p.score}</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {gameState.step === 'end' && (
                            <div className="animate-pop">
                                <div className="text-9xl mb-8 animate-bounce">ğŸ‘‘</div>
                                <h1 className="text-7xl font-black text-yellow-400 mb-8 drop-shadow-lg">æœ€çµ‚å† è»</h1>
                                <div className="text-6xl font-bold mb-12">{players[0]?.name}</div>
                                <div className="text-4xl text-gray-400">å¾—åˆ†ï¼š{players[0]?.score}</div>
                            </div>
                        )}
                    </div>

                    {gameState.step !== 'lobby' && gameState.step !== 'end' && (
                        <div className="p-6 bg-gray-800 flex justify-center gap-6 border-t border-gray-700">
                            {gameState.step === 'question' && <button onClick={() => hostAction('reveal')} className="bg-yellow-600 hover:bg-yellow-500 px-10 py-4 rounded-xl font-bold text-2xl shadow-lg btn-push">å…¬ä½ˆç­”æ¡ˆ</button>}
                            {gameState.step === 'reveal' && <button onClick={() => hostAction('leaderboard')} className="bg-blue-600 hover:bg-blue-500 px-10 py-4 rounded-xl font-bold text-2xl shadow-lg btn-push">çœ‹æ’è¡Œ</button>}
                            {gameState.step === 'leaderboard' && <button onClick={() => hostAction('nextQ')} className="bg-green-600 hover:bg-green-500 px-10 py-4 rounded-xl font-bold text-2xl shadow-lg btn-push">ä¸‹ä¸€é¡Œ âœ</button>}
                        </div>
                    )}
                </div>
            );

            // 3. åƒè³½è€…ç•«é¢ (æ‰‹æ©Ÿ)
            if (view === 'player') return (
                <div className="min-h-screen bg-gray-900 flex flex-col p-4">
                    <div className="flex justify-between items-center mb-6 bg-gray-800 p-3 rounded-xl shadow-md">
                        <div className="font-bold text-xl truncate max-w-[150px]">{myPlayer.name}</div>
                        <div className="bg-gray-700 px-4 py-2 rounded-lg font-mono font-bold text-yellow-400">Score: {myPlayer.score}</div>
                    </div>

                    <div className="flex-1 flex flex-col justify-center text-center">
                        {gameState.step === 'lobby' && (
                            <div className="animate-pulse flex flex-col items-center">
                                <div className="text-8xl mb-6">â³</div>
                                <h2 className="text-3xl font-bold mb-2">å·²é€£ç·šæˆåŠŸ</h2>
                                <p className="text-gray-400">è«‹çœ‹å¤§è¢å¹•ï¼Œç­‰å¾…é–‹å§‹...</p>
                            </div>
                        )}

                        {gameState.step === 'question' && gameState.qIndex !== myPlayer.lastQ && (
                            <div className="grid grid-cols-2 gap-4 h-full max-h-[600px]">
                                {['A', 'B', 'C', 'D'].map((label, idx) => (
                                    <button key={idx} onClick={() => playerAnswer(idx)} className={`rounded-3xl text-7xl font-black text-white shadow-xl btn-push flex items-center justify-center border-b-8 active:border-b-0 active:translate-y-2 transition-all ${
                                        ['bg-red-500 border-red-800', 'bg-blue-500 border-blue-800', 'bg-yellow-500 border-yellow-800', 'bg-green-500 border-green-800'][idx]
                                    }`}>
                                        {label}
                                    </button>
                                ))}
                                <p className="col-span-2 text-gray-500 mt-4 font-bold text-lg animate-pulse">è«‹çœ‹å¤§è¢å¹•é¡Œç›®ä½œç­”</p>
                            </div>
                        )}

                        {gameState.step === 'question' && gameState.qIndex === myPlayer.lastQ && (
                            <div className="animate-pop">
                                <div className="text-8xl mb-6 animate-bounce">ğŸš€</div>
                                <h2 className="text-4xl font-black text-green-400">ç­”æ¡ˆå·²é€å‡º</h2>
                                <p className="text-gray-400 mt-4">ç­‰å¾…çµæœ...</p>
                            </div>
                        )}

                        {(gameState.step === 'reveal' || gameState.step === 'leaderboard') && (
                            <div className="bg-gray-800 p-8 rounded-3xl shadow-xl border border-gray-700">
                                <h2 className="text-3xl font-bold mb-4">æœ¬é¡ŒçµæŸ</h2>
                                <p className="text-gray-400 text-lg">æ­£ç¢ºç­”æ¡ˆè«‹çœ‹å¤§è¢å¹•</p>
                            </div>
                        )}
                        
                        {gameState.step === 'end' && (
                            <div className="animate-pop">
                                <h2 className="text-3xl font-bold mb-6">æœ€çµ‚å¾—åˆ†</h2>
                                <div className="text-8xl font-mono font-black text-yellow-400 mb-8">{myPlayer.score}</div>
                                <div className="text-gray-400">æ„Ÿè¬åƒèˆ‡ï¼</div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
